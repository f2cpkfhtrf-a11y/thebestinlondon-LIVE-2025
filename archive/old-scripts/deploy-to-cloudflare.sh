#!/bin/bash

# Cloudflare Pages Deployment Automation
# Project: thebestinlondon

echo "ğŸš€ CLOUDFLARE PAGES DEPLOYMENT SCRIPT"
echo "======================================"
echo ""

ACCOUNT_ID="9947c88df88e197e6588e6f5fdb734a6"
PROJECT_NAME="thebestinlondon"
GITHUB_REPO="f2cpkfhtrf-a11y/thebestinlondon-LIVE-2025"

echo "âœ… Account ID: $ACCOUNT_ID"
echo "âœ… GitHub Repo: $GITHUB_REPO"
echo ""

# Check if we're in the right directory
if [ ! -f "package.json" ]; then
    echo "âŒ Error: Not in project directory"
    echo "Please run: cd ~/Desktop/thebestinlondon"
    exit 1
fi

echo "ğŸ“ Current directory: $(pwd)"
echo ""

# Open Cloudflare Workers & Pages
echo "ğŸŒ Opening Cloudflare Workers & Pages..."
open "https://dash.cloudflare.com/$ACCOUNT_ID/workers-and-pages"

echo ""
echo "ğŸ” CHECKING CLOUDFLARE PAGES STATUS..."
echo ""
echo "Please check the Cloudflare dashboard that just opened:"
echo ""
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "IF YOU SEE A PROJECT CALLED 'thebestinlondon':"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "  1. Click on the project"
echo "  2. Check deployment status:"
echo "     â€¢ âœ… SUCCESS â†’ Copy the URL (thebestinlondon.pages.dev)"
echo "     â€¢ âŒ FAILED â†’ Click to see error logs"
echo "     â€¢ ğŸ”„ IN PROGRESS â†’ Wait 2-3 minutes"
echo ""
echo "  3. If you want to trigger a new deployment:"
echo "     â€¢ Go to Settings â†’ Builds & deployments"
echo "     â€¢ Click 'Retry deployment' on latest build"
echo ""
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "IF YOU DON'T SEE 'thebestinlondon' PROJECT:"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "  You need to create it! Here's how:"
echo ""
echo "  1. Click 'Create application' button"
echo "  2. Click 'Pages' tab"
echo "  3. Click 'Connect to Git'"
echo "  4. Select GitHub repository: $GITHUB_REPO"
echo "  5. Click 'Begin setup'"
echo ""
echo "  6. Configure build settings:"
echo "     â€¢ Project name: thebestinlondon"
echo "     â€¢ Production branch: main"
echo "     â€¢ Framework preset: Next.js"
echo "     â€¢ Build command: npm run build"
echo "     â€¢ Build output directory: .next"
echo ""
echo "  7. Click 'Save and Deploy'"
echo ""
echo "  Build will take 2-3 minutes!"
echo ""
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""

# Ask user what they see
echo "â“ WHAT DO YOU SEE IN CLOUDFLARE?"
echo ""
echo "Type one of these and press Enter:"
echo "  A - Project exists and is SUCCESS âœ…"
echo "  B - Project exists and is FAILED âŒ"
echo "  C - Project exists and is IN PROGRESS ğŸ”„"
echo "  D - No project found, need to create âš™ï¸"
echo ""
read -p "Your answer (A/B/C/D): " answer

case $answer in
    A|a)
        echo ""
        echo "ğŸ‰ EXCELLENT! Your site is LIVE!"
        echo ""
        echo "ğŸ“‹ NEXT STEPS:"
        echo "  1. Copy your Cloudflare Pages URL (should be: thebestinlondon.pages.dev)"
        echo "  2. Test it in browser"
        echo "  3. If working, update DNS to point thebestinlondon.co.uk to it"
        echo ""
        read -p "Paste your .pages.dev URL here: " pages_url
        echo ""
        echo "ğŸŒ Opening your live site: $pages_url"
        open "$pages_url"
        echo ""
        echo "âœ… DEPLOYMENT COMPLETE!"
        ;;
    B|b)
        echo ""
        echo "ğŸ”§ DEPLOYMENT FAILED - Let's fix it!"
        echo ""
        echo "ğŸ“‹ STEPS TO FIX:"
        echo "  1. In Cloudflare dashboard, click on the failed deployment"
        echo "  2. Scroll down to see the error logs"
        echo "  3. Copy the error message"
        echo ""
        echo "Then I can help you fix it!"
        echo ""
        echo "Common issues and fixes:"
        echo "  â€¢ 'npm install failed' â†’ Usually a package issue"
        echo "  â€¢ 'Build failed' â†’ Check build logs for specific error"
        echo "  â€¢ 'next.config.js error' â†’ Config syntax issue"
        echo ""
        read -p "Press Enter when you have the error message..."
        echo ""
        echo "Paste the error here, and I'll help fix it!"
        ;;
    C|c)
        echo ""
        echo "â³ BUILD IN PROGRESS - Almost there!"
        echo ""
        echo "Your site is being built right now. This takes 2-3 minutes."
        echo ""
        echo "ğŸ“‹ WHAT TO DO:"
        echo "  1. Wait 2-3 minutes"
        echo "  2. Refresh the Cloudflare page"
        echo "  3. Check if status changed to SUCCESS âœ…"
        echo ""
        echo "â˜• Grab a coffee and come back in 3 minutes!"
        echo ""
        read -p "Press Enter when build is complete..."
        echo ""
        echo "Now run this script again and select option A!"
        ;;
    D|d)
        echo ""
        echo "ğŸ”§ NO PROJECT FOUND - Let's create it!"
        echo ""
        echo "ğŸ“‹ FOLLOW THESE STEPS IN CLOUDFLARE:"
        echo ""
        echo "1. Click 'Create application' (blue button)"
        echo "2. Click 'Pages' tab"
        echo "3. Click 'Connect to Git'"
        echo ""
        read -p "Done? Press Enter to continue..."
        echo ""
        echo "4. Authorize GitHub access (if prompted)"
        echo "5. Select repository: $GITHUB_REPO"
        echo "6. Click 'Begin setup'"
        echo ""
        read -p "Done? Press Enter to continue..."
        echo ""
        echo "7. Enter these settings:"
        echo "   â€¢ Project name: thebestinlondon"
        echo "   â€¢ Production branch: main"
        echo "   â€¢ Framework preset: Next.js"
        echo "   â€¢ Build command: npm run build"
        echo "   â€¢ Build output directory: .next"
        echo ""
        echo "8. Scroll down"
        echo "9. Click 'Save and Deploy' (blue button)"
        echo ""
        read -p "Done? Press Enter when deployment starts..."
        echo ""
        echo "ğŸ‰ DEPLOYMENT STARTED!"
        echo ""
        echo "â³ This will take 2-3 minutes."
        echo "You'll see the build progress in Cloudflare."
        echo ""
        echo "When it's done, run this script again and select option A!"
        ;;
    *)
        echo ""
        echo "Invalid option. Please run the script again."
        ;;
esac

echo ""
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "ğŸ“– DOCUMENTATION"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "â€¢ Full guide: CHECK-CLOUDFLARE-NOW.md"
echo "â€¢ Project status: COMPLETE-STATUS-OCT-15.md"
echo "â€¢ Build details: BUILD-STATUS.md"
echo ""
echo "ğŸš€ Script complete!"
